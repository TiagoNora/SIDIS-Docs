<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1555px" preserveAspectRatio="none" style="width:2213px;height:1555px;background:#FFFFFF;" version="1.1" viewBox="0 0 2213 1555" width="2213px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="120" x="1045.5" y="30.1074">Vote for a review</text><rect fill="#FFFFFF" height="1181.5156" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="281.6973"/><rect fill="#FFFFFF" height="1141.2246" style="stroke:#181818;stroke-width:1.0;" width="10" x="196" y="312.9883"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="271" y="1013.7207"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="374" y="1089.3027"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="477" y="1164.8848"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="580" y="1240.4668"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="683" y="1316.0488"/><rect fill="#FFFFFF" height="1078.6426" style="stroke:#181818;stroke-width:1.0;" width="10" x="793.5" y="344.2793"/><rect fill="#FFFFFF" height="1016.0605" style="stroke:#181818;stroke-width:1.0;" width="10" x="1070.5" y="375.5703"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1276.5" y="919.8477"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="406.8613"/><rect fill="#FFFFFF" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="469.4434"/><rect fill="#FFFFFF" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="594.6074"/><rect fill="#FFFFFF" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="794.6836"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1823" y="625.8984"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1823" y="825.9746"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1941" y="500.7344"/><rect fill="#FFFFFF" height="1306.6797" style="stroke:#181818;stroke-width:1.0;" width="10" x="2143.5" y="156.5332"/><rect fill="#FFFFFF" height="1275.3887" style="stroke:#181818;stroke-width:1.0;" width="10" x="2148.5" y="187.8242"/><rect fill="#FFFFFF" height="1244.0977" style="stroke:#181818;stroke-width:1.0;" width="10" x="2153.5" y="219.1152"/><rect fill="#FFFFFF" height="1212.8066" style="stroke:#181818;stroke-width:1.0;" width="10" x="2158.5" y="250.4063"/><rect fill="#FFFFFF" height="1181.5156" style="stroke:#181818;stroke-width:1.0;" width="10" x="2163.5" y="281.6973"/><rect fill="#FFFFFF" height="480.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="2168.5" y="982.4297"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="200.5" x2="200.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="275.5" x2="275.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="379" x2="379" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="482" x2="482" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="584.5" x2="584.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="687.5" x2="687.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="798.5" x2="798.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1075.5" x2="1075.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1281.5" x2="1281.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1502.5" x2="1502.5" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1828" x2="1828" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1946" x2="1946" y1="123.2422" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2043" x2="2043" y1="728.291" y2="1472.2129"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2148" x2="2148" y1="123.2422" y2="1472.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="119.7285">Client</text><ellipse cx="26" cy="53.1211" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,61.1211 L26,88.1211 M13,69.1211 L39,69.1211 M26,88.1211 L13,103.1211 M26,88.1211 L39,103.1211 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="1486.3203">Client</text><ellipse cx="26" cy="1498.334" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,1506.334 L26,1533.334 M13,1514.334 L39,1514.334 M26,1533.334 L13,1548.334 M26,1533.334 L39,1548.334 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="172.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="179.5" y="111.7285">:VoteC</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="172.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="179.5" y="1493.3203">:VoteC</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="239.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="246.5" y="111.7285">:VoteC_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="239.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="246.5" y="1493.3203">:VoteC_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58" x="350" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="357" y="111.7285">:VoteQ</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58" x="350" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="357" y="1493.3203">:VoteQ</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="445" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="452" y="111.7285">:VoteQ_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="445" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="452" y="1493.3203">:VoteQ_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="548.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="555.5" y="111.7285">:ReviewC</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="548.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="555.5" y="1493.3203">:ReviewC</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89" x="643.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="650.5" y="111.7285">:ReviewC_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89" x="643.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="650.5" y="1493.3203">:ReviewC_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="742.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="749.5" y="111.7285">VotesController</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="742.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="749.5" y="1493.3203">VotesController</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182" x="984.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="991.5" y="111.7285">votesService:VotesService</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182" x="984.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="991.5" y="1493.3203">votesService:VotesService</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1176.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="1183.5" y="111.7285">voteRepository:VoteRepository</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="210" x="1176.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="1183.5" y="1493.3203">voteRepository:VoteRepository</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213" x="1396.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="1403.5" y="111.7285">requestService:RequestService</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213" x="1396.5" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="1403.5" y="1493.3203">requestService:RequestService</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1770" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1777" y="111.7285">:ReviewInstance</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1770" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1777" y="1493.3203">:ReviewInstance</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="1896" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="1903" y="111.7285">:AuthInstance</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="1896" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="1903" y="1493.3203">:AuthInstance</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="2006" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="2013" y="1493.3203">vote:Vote</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="2090" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="2097" y="111.7285">:MessageBroker</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="2090" y="1471.2129"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="2097" y="1493.3203">:MessageBroker</text><rect fill="#FFFFFF" height="1181.5156" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="281.6973"/><rect fill="#FFFFFF" height="1141.2246" style="stroke:#181818;stroke-width:1.0;" width="10" x="196" y="312.9883"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="271" y="1013.7207"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="374" y="1089.3027"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="477" y="1164.8848"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="580" y="1240.4668"/><rect fill="#FFFFFF" height="37.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="683" y="1316.0488"/><rect fill="#FFFFFF" height="1078.6426" style="stroke:#181818;stroke-width:1.0;" width="10" x="793.5" y="344.2793"/><rect fill="#FFFFFF" height="1016.0605" style="stroke:#181818;stroke-width:1.0;" width="10" x="1070.5" y="375.5703"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1276.5" y="919.8477"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="406.8613"/><rect fill="#FFFFFF" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="469.4434"/><rect fill="#FFFFFF" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="594.6074"/><rect fill="#FFFFFF" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1498" y="794.6836"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1823" y="625.8984"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1823" y="825.9746"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="1941" y="500.7344"/><rect fill="#FFFFFF" height="1306.6797" style="stroke:#181818;stroke-width:1.0;" width="10" x="2143.5" y="156.5332"/><rect fill="#FFFFFF" height="1275.3887" style="stroke:#181818;stroke-width:1.0;" width="10" x="2148.5" y="187.8242"/><rect fill="#FFFFFF" height="1244.0977" style="stroke:#181818;stroke-width:1.0;" width="10" x="2153.5" y="219.1152"/><rect fill="#FFFFFF" height="1212.8066" style="stroke:#181818;stroke-width:1.0;" width="10" x="2158.5" y="250.4063"/><rect fill="#FFFFFF" height="1181.5156" style="stroke:#181818;stroke-width:1.0;" width="10" x="2163.5" y="281.6973"/><rect fill="#FFFFFF" height="480.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="2168.5" y="982.4297"/><polygon fill="#181818" points="2131.5,152.5332,2141.5,156.5332,2131.5,160.5332,2135.5,156.5332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="276" x2="2137.5" y1="156.5332" y2="156.5332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="283" y="151.2705">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="294" y="151.2705">subscribe "Vote.created"</text><polygon fill="#181818" points="2136.5,183.8242,2146.5,187.8242,2136.5,191.8242,2140.5,187.8242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="379" x2="2142.5" y1="187.8242" y2="187.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="386" y="182.5615">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="397" y="182.5615">subscribe "Vote.created"</text><polygon fill="#181818" points="2141.5,215.1152,2151.5,219.1152,2141.5,223.1152,2145.5,219.1152" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="482" x2="2147.5" y1="219.1152" y2="219.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="489" y="213.8525">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="500" y="213.8525">subscribe "Vote.created"</text><polygon fill="#181818" points="2146.5,246.4063,2156.5,250.4063,2146.5,254.4063,2150.5,250.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="2152.5" y1="250.4063" y2="250.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="592" y="245.1436">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="603" y="245.1436">subscribe "Vote.created"</text><polygon fill="#181818" points="2151.5,277.6973,2161.5,281.6973,2151.5,285.6973,2155.5,281.6973" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="688" x2="2157.5" y1="281.6973" y2="281.6973"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="695" y="276.4346">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="706" y="276.4346">subscribe "Vote.created"</text><polygon fill="#181818" points="184,308.9883,194,312.9883,184,316.9883,188,312.9883" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="190" y1="312.9883" y2="312.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="38" y="307.7256">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="49" y="307.7256">POST /votes/{idReview}</text><polygon fill="#181818" points="781.5,340.2793,791.5,344.2793,781.5,348.2793,785.5,344.2793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="206" x2="787.5" y1="344.2793" y2="344.2793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="213" y="339.0166">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="224" y="339.0166">POST /votes/{idReview}</text><polygon fill="#181818" points="1058.5,371.5703,1068.5,375.5703,1058.5,379.5703,1062.5,375.5703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="803.5" x2="1064.5" y1="375.5703" y2="375.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="810.5" y="370.3076">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="821.5" y="370.3076">service.create(resource,idReview,idUser);</text><polygon fill="#181818" points="1486,402.8613,1496,406.8613,1486,410.8613,1490,406.8613" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1080.5" x2="1492" y1="406.8613" y2="406.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1087.5" y="401.5986">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="1098.5" y="401.5986">parseJwt(request)</text><polygon fill="#181818" points="1091.5,434.1523,1081.5,438.1523,1091.5,442.1523,1087.5,438.1523" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1085.5" x2="1502" y1="438.1523" y2="438.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1097.5" y="432.8896">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="1115.5" y="432.8896">jwt</text><polygon fill="#181818" points="1486,465.4434,1496,469.4434,1486,473.4434,1490,469.4434" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1080.5" x2="1492" y1="469.4434" y2="469.4434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1087.5" y="464.1807">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="1105.5" y="464.1807">makeRequestToAuthentication(jwt)</text><polygon fill="#181818" points="1929,496.7344,1939,500.7344,1929,504.7344,1933,500.7344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1508" x2="1935" y1="500.7344" y2="500.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1515" y="495.4717">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="1533" y="495.4717">GET /auth/search/{jwt}</text><polygon fill="#181818" points="1519,528.0254,1509,532.0254,1519,536.0254,1515,532.0254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1513" x2="1945" y1="532.0254" y2="532.0254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1525" y="526.7627">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25" x="1543" y="526.7627">user</text><polygon fill="#181818" points="1091.5,559.3164,1081.5,563.3164,1091.5,567.3164,1087.5,563.3164" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1085.5" x2="1502" y1="563.3164" y2="563.3164"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1097.5" y="558.0537">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25" x="1115.5" y="558.0537">user</text><polygon fill="#181818" points="1486,590.6074,1496,594.6074,1486,598.6074,1490,594.6074" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1080.5" x2="1492" y1="594.6074" y2="594.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1087.5" y="589.3447">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="1105.5" y="589.3447">retrieveReviewFromApi(reviewId)</text><polygon fill="#181818" points="1811,621.8984,1821,625.8984,1811,629.8984,1815,625.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1508" x2="1817" y1="625.8984" y2="625.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1515" y="620.6357">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="1533" y="620.6357">GET /reviews/search/{reviewId}</text><polygon fill="#181818" points="1519,653.1895,1509,657.1895,1519,661.1895,1515,657.1895" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1513" x2="1827" y1="657.1895" y2="657.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1525" y="651.9268">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="1543" y="651.9268">review</text><polygon fill="#181818" points="1091.5,684.4805,1081.5,688.4805,1091.5,692.4805,1087.5,688.4805" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1085.5" x2="1502" y1="688.4805" y2="688.4805"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1097.5" y="683.2178">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="1115.5" y="683.2178">review</text><polygon fill="#181818" points="1994,715.7715,2004,719.7715,1994,723.7715,1998,719.7715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1080.5" x2="2000" y1="719.7715" y2="719.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1087.5" y="714.5088">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="1105.5" y="714.5088">new(resource.getVote(),user.getId,reviewId)</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="2006" y="696.4805"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="2013" y="718.5879">vote:Vote</text><polygon fill="#181818" points="1091.5,759.3926,1081.5,763.3926,1091.5,767.3926,1087.5,763.3926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1085.5" x2="2042" y1="763.3926" y2="763.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1097.5" y="758.1299">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="1115.5" y="758.1299">vote</text><polygon fill="#181818" points="1486,790.6836,1496,794.6836,1486,798.6836,1490,794.6836" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1080.5" x2="1492" y1="794.6836" y2="794.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1087.5" y="789.4209">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="1105.5" y="789.4209">updateReview(reviewId), resource.getVote())</text><polygon fill="#181818" points="1811,821.9746,1821,825.9746,1811,829.9746,1815,825.9746" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1508" x2="1817" y1="825.9746" y2="825.9746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1515" y="820.7119">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278" x="1533" y="820.7119">PUT /reviews/vote/{reviewId}/{resource.getVote()}</text><polygon fill="#181818" points="1519,853.2656,1509,857.2656,1519,861.2656,1515,857.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1513" x2="1827" y1="857.2656" y2="857.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1525" y="852.0029">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="1543" y="852.0029">ok</text><polygon fill="#181818" points="1091.5,884.5566,1081.5,888.5566,1091.5,892.5566,1087.5,888.5566" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1085.5" x2="1502" y1="888.5566" y2="888.5566"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1097.5" y="883.2939">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="1115.5" y="883.2939">ok</text><polygon fill="#181818" points="1264.5,915.8477,1274.5,919.8477,1264.5,923.8477,1268.5,919.8477" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1080.5" x2="1270.5" y1="919.8477" y2="919.8477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1087.5" y="914.585">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="1105.5" y="914.585">save(vote)</text><polygon fill="#181818" points="1091.5,947.1387,1081.5,951.1387,1091.5,955.1387,1087.5,951.1387" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1085.5" x2="1280.5" y1="951.1387" y2="951.1387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1097.5" y="945.876">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="1115.5" y="945.876">ok</text><polygon fill="#181818" points="2156.5,978.4297,2166.5,982.4297,2156.5,986.4297,2160.5,982.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1080.5" x2="2162.5" y1="982.4297" y2="982.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1087.5" y="977.167">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="1105.5" y="977.167">publish "Vote.created, {Vote}"</text><polygon fill="#181818" points="292,1009.7207,282,1013.7207,292,1017.7207,288,1013.7207" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="286" x2="2167.5" y1="1013.7207" y2="1013.7207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="298" y="1008.458">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="316" y="1008.458">notify "Vote.created, {Vote}"</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="281" x2="323" y1="1050.0117" y2="1050.0117"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="323" x2="323" y1="1050.0117" y2="1063.0117"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="276" x2="323" y1="1063.0117" y2="1063.0117"/><polygon fill="#181818" points="286,1059.0117,276,1063.0117,286,1067.0117,282,1063.0117" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="288" y="1044.749">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="306" y="1044.749">save(Vote)</text><polygon fill="#181818" points="395,1085.3027,385,1089.3027,395,1093.3027,391,1089.3027" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="389" x2="2167.5" y1="1089.3027" y2="1089.3027"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="401" y="1084.04">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="419" y="1084.04">notify "Vote.created, {Vote}"</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="384" x2="426" y1="1125.5938" y2="1125.5938"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="426" x2="426" y1="1125.5938" y2="1138.5938"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="379" x2="426" y1="1138.5938" y2="1138.5938"/><polygon fill="#181818" points="389,1134.5938,379,1138.5938,389,1142.5938,385,1138.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="391" y="1120.3311">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="409" y="1120.3311">save(Vote)</text><polygon fill="#181818" points="498,1160.8848,488,1164.8848,498,1168.8848,494,1164.8848" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="492" x2="2167.5" y1="1164.8848" y2="1164.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="504" y="1159.6221">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="522" y="1159.6221">notify "Vote.created, {Vote}"</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="487" x2="529" y1="1201.1758" y2="1201.1758"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="529" x2="529" y1="1201.1758" y2="1214.1758"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="482" x2="529" y1="1214.1758" y2="1214.1758"/><polygon fill="#181818" points="492,1210.1758,482,1214.1758,492,1218.1758,488,1214.1758" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="494" y="1195.9131">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="512" y="1195.9131">save(Vote)</text><polygon fill="#181818" points="601,1236.4668,591,1240.4668,601,1244.4668,597,1240.4668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="595" x2="2167.5" y1="1240.4668" y2="1240.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="607" y="1235.2041">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="625" y="1235.2041">notify "Vote.created, {Vote}"</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="632" y1="1276.7578" y2="1276.7578"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="632" y1="1276.7578" y2="1289.7578"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="585" x2="632" y1="1289.7578" y2="1289.7578"/><polygon fill="#181818" points="595,1285.7578,585,1289.7578,595,1293.7578,591,1289.7578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="597" y="1271.4951">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="615" y="1271.4951">save(Vote)</text><polygon fill="#181818" points="704,1312.0488,694,1316.0488,704,1320.0488,700,1316.0488" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="698" x2="2167.5" y1="1316.0488" y2="1316.0488"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="710" y="1310.7861">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="728" y="1310.7861">notify "Vote.created, {Vote}"</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="693" x2="735" y1="1352.3398" y2="1352.3398"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="735" x2="735" y1="1352.3398" y2="1365.3398"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="688" x2="735" y1="1365.3398" y2="1365.3398"/><polygon fill="#181818" points="698,1361.3398,688,1365.3398,698,1369.3398,694,1365.3398" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="700" y="1347.0771">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="718" y="1347.0771">save(Vote)</text><polygon fill="#181818" points="814.5,1387.6309,804.5,1391.6309,814.5,1395.6309,810.5,1391.6309" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="808.5" x2="1074.5" y1="1391.6309" y2="1391.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="820.5" y="1386.3682">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="838.5" y="1386.3682">ok</text><polygon fill="#181818" points="217,1418.9219,207,1422.9219,217,1426.9219,213,1422.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="211" x2="797.5" y1="1422.9219" y2="1422.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="223" y="1417.6592">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="241" y="1417.6592">ok</text><polygon fill="#181818" points="42,1450.2129,32,1454.2129,42,1458.2129,38,1454.2129" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="200" y1="1454.2129" y2="1454.2129"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="48" y="1448.9502">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="66" y="1448.9502">ok</text><!--MD5=[2abadb5fa05116c1e5452b54b83e118a]
@startuml
'https://plantuml.com/sequence-diagram

title Vote for a review
autoactivate on
autonumber

actor "Client" as User
participant ":VoteC" as voteC
participant ":VoteC_n" as voteC_n
participant ":VoteQ" as voteQ
participant ":VoteQ_n" as voteQ_n
participant ":ReviewC" as reviewC
participant ":ReviewC_n" as reviewC_n
participant "VotesController" as Ctrl
participant "votesService:VotesService" as service
participant "voteRepository:VoteRepository" as repo
participant "requestService:RequestService" as request
participant ":ReviewInstance" as instance
participant ":AuthInstance" as instanceAuth

participant "vote:Vote" as vote
participant ":MessageBroker" as broker


voteC_n -> broker: subscribe "Vote.created"
voteQ -> broker: subscribe "Vote.created"
voteQ_n -> broker: subscribe "Vote.created"
reviewC -> broker: subscribe "Vote.created"
reviewC_n -> broker: subscribe "Vote.created"

activate User
User -> voteC : POST /votes/{idReview}
voteC -> Ctrl:  POST /votes/{idReview}
Ctrl -> service : service.create(resource,idReview,idUser);
service -> request: parseJwt(request)
request - -> service: jwt
service -> request: makeRequestToAuthentication(jwt)
request -> instanceAuth: GET /auth/search/{jwt}
instanceAuth - -> request: user
request - -> service: user

service -> request:retrieveReviewFromApi(reviewId)
request -> instance: GET /reviews/search/{reviewId}
instance - -> request: review
request - -> service: review

service -> vote**: new(resource.getVote(),user.getId,reviewId)
vote - -> service: vote
service -> request: updateReview(reviewId), resource.getVote())
request -> instance: PUT /reviews/vote/{reviewId}/{resource.getVote()}
instance - -> request: ok
request - -> service: ok
service -> repo: save(vote)
repo - -> service: ok
service -> broker: publish "Vote.created, {Vote}"

voteC_n <- broker: notify "Vote.created, {Vote}"
voteC_n - -> voteC_n: save(Vote)
voteQ <- broker: notify "Vote.created, {Vote}"
voteQ - -> voteQ: save(Vote)
voteQ_n <- broker: notify "Vote.created, {Vote}"
voteQ_n - -> voteQ_n: save(Vote)
reviewC <- broker: notify "Vote.created, {Vote}"
reviewC - -> reviewC: save(Vote)
reviewC_n <- broker: notify "Vote.created, {Vote}"
reviewC_n - -> reviewC_n: save(Vote)

service - -> Ctrl: ok
Ctrl - -> voteC: ok
voteC - -> User: ok

@enduml

@startuml

title Vote for a review
autoactivate on
autonumber

actor "Client" as User
participant ":VoteC" as voteC
participant ":VoteC_n" as voteC_n
participant ":VoteQ" as voteQ
participant ":VoteQ_n" as voteQ_n
participant ":ReviewC" as reviewC
participant ":ReviewC_n" as reviewC_n
participant "VotesController" as Ctrl
participant "votesService:VotesService" as service
participant "voteRepository:VoteRepository" as repo
participant "requestService:RequestService" as request
participant ":ReviewInstance" as instance
participant ":AuthInstance" as instanceAuth

participant "vote:Vote" as vote
participant ":MessageBroker" as broker


voteC_n -> broker: subscribe "Vote.created"
voteQ -> broker: subscribe "Vote.created"
voteQ_n -> broker: subscribe "Vote.created"
reviewC -> broker: subscribe "Vote.created"
reviewC_n -> broker: subscribe "Vote.created"

activate User
User -> voteC : POST /votes/{idReview}
voteC -> Ctrl:  POST /votes/{idReview}
Ctrl -> service : service.create(resource,idReview,idUser);
service -> request: parseJwt(request)
request - -> service: jwt
service -> request: makeRequestToAuthentication(jwt)
request -> instanceAuth: GET /auth/search/{jwt}
instanceAuth - -> request: user
request - -> service: user

service -> request:retrieveReviewFromApi(reviewId)
request -> instance: GET /reviews/search/{reviewId}
instance - -> request: review
request - -> service: review

service -> vote**: new(resource.getVote(),user.getId,reviewId)
vote - -> service: vote
service -> request: updateReview(reviewId), resource.getVote())
request -> instance: PUT /reviews/vote/{reviewId}/{resource.getVote()}
instance - -> request: ok
request - -> service: ok
service -> repo: save(vote)
repo - -> service: ok
service -> broker: publish "Vote.created, {Vote}"

voteC_n <- broker: notify "Vote.created, {Vote}"
voteC_n - -> voteC_n: save(Vote)
voteQ <- broker: notify "Vote.created, {Vote}"
voteQ - -> voteQ: save(Vote)
voteQ_n <- broker: notify "Vote.created, {Vote}"
voteQ_n - -> voteQ_n: save(Vote)
reviewC <- broker: notify "Vote.created, {Vote}"
reviewC - -> reviewC: save(Vote)
reviewC_n <- broker: notify "Vote.created, {Vote}"
reviewC_n - -> reviewC_n: save(Vote)

service - -> Ctrl: ok
Ctrl - -> voteC: ok
voteC - -> User: ok

@enduml

PlantUML version 1.2022.13(Sat Nov 19 13:22:17 WET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>