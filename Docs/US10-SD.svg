<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="590px" preserveAspectRatio="none" style="width:1365px;height:590px;background:#FFFFFF;" version="1.1" viewBox="0 0 1365 590" width="1365px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="25.6406" id="_title" style="stroke:none;stroke-width:1.0;" width="260" x="551.5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="250" x="556.5" y="27.6738">Approve or reject a pending review</text><rect fill="#FFFFFF" height="373.8047" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="127.2813"/><rect fill="#FFFFFF" height="9" style="stroke:#181818;stroke-width:1.0;" width="10" x="26" y="492.0859"/><rect fill="#FFFFFF" height="353.2813" style="stroke:#181818;stroke-width:1.0;" width="10" x="253" y="147.8047"/><rect fill="#FFFFFF" height="37.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="258" y="463.5625"/><rect fill="#FFFFFF" height="324.7578" style="stroke:#181818;stroke-width:1.0;" width="10" x="566" y="176.3281"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="898" y="399.5156"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="1134" y="204.8516"/><rect fill="#FFFFFF" height="85.5703" style="stroke:#181818;stroke-width:1.0;" width="10" x="1134" y="261.8984"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="1304" y="290.4219"/><rect fill="none" height="73.5703" style="stroke:#000000;stroke-width:1.5;" width="570" x="462.5" y="362.4688"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="117.2813" y2="510.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="257.5" x2="257.5" y1="117.2813" y2="510.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="570.5" x2="570.5" y1="117.2813" y2="510.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="902.5" x2="902.5" y1="117.2813" y2="510.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1138.5" x2="1138.5" y1="117.2813" y2="510.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1309" x2="1309" y1="117.2813" y2="510.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="114.3145">Client</text><ellipse cx="26" cy="50.1406" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,58.1406 L26,85.1406 M13,66.1406 L39,66.1406 M26,85.1406 L13,100.1406 M26,85.1406 L39,100.1406 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="521.7598">Client</text><ellipse cx="26" cy="533.2266" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,541.2266 L26,568.2266 M13,549.2266 L39,549.2266 M26,568.2266 L13,583.2266 M26,568.2266 L39,583.2266 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="187.5" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="194.5" y="106.3145">ModeratorController</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="187.5" y="509.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="194.5" y="528.7598">ModeratorController</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="197" x="472.5" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183" x="479.5" y="106.3145">reviewService:ReviewService</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="197" x="472.5" y="509.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183" x="479.5" y="528.7598">reviewService:ReviewService</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="239" x="783.5" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225" x="790.5" y="106.3145">reviewRepository:ReviewRepository</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="239" x="783.5" y="509.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225" x="790.5" y="528.7598">reviewRepository:ReviewRepository</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213" x="1032.5" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="1039.5" y="106.3145">requestService:RequestService</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213" x="1032.5" y="509.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="1039.5" y="528.7598">requestService:RequestService</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="1259" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="1266" y="106.3145">:AuthInstance</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="1259" y="509.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="1266" y="528.7598">:AuthInstance</text><rect fill="#FFFFFF" height="373.8047" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="127.2813"/><rect fill="#FFFFFF" height="9" style="stroke:#181818;stroke-width:1.0;" width="10" x="26" y="492.0859"/><rect fill="#FFFFFF" height="353.2813" style="stroke:#181818;stroke-width:1.0;" width="10" x="253" y="147.8047"/><rect fill="#FFFFFF" height="37.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="258" y="463.5625"/><rect fill="#FFFFFF" height="324.7578" style="stroke:#181818;stroke-width:1.0;" width="10" x="566" y="176.3281"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="898" y="399.5156"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="1134" y="204.8516"/><rect fill="#FFFFFF" height="85.5703" style="stroke:#181818;stroke-width:1.0;" width="10" x="1134" y="261.8984"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="1304" y="290.4219"/><polygon fill="#181818" points="241,143.8047,251,147.8047,241,151.8047,245,147.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="247" y1="147.8047" y2="147.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="38" y="143.0498">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="49" y="143.0498">PUT /moderator/review/{idReview}</text><polygon fill="#181818" points="554,172.3281,564,176.3281,554,180.3281,558,176.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="263" x2="560" y1="176.3281" y2="176.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="270" y="171.5732">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273" x="281" y="171.5732">reviewService.changeStatus(idReview,resource)</text><polygon fill="#181818" points="1122,200.8516,1132,204.8516,1122,208.8516,1126,204.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="1128" y1="204.8516" y2="204.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="583" y="200.0967">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="594" y="200.0967">parseJwt(request)</text><polygon fill="#181818" points="587,229.375,577,233.375,587,237.375,583,233.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="581" x2="1138" y1="233.375" y2="233.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="593" y="228.6201">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="604" y="228.6201">jwt</text><polygon fill="#181818" points="1122,257.8984,1132,261.8984,1122,265.8984,1126,261.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="1128" y1="261.8984" y2="261.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="583" y="257.1436">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="594" y="257.1436">makeRequestToAuthentication(jwt)</text><polygon fill="#181818" points="1292,286.4219,1302,290.4219,1292,294.4219,1296,290.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1144" x2="1298" y1="290.4219" y2="290.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1151" y="285.667">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="1162" y="285.667">GET /auth/search/{jwt}</text><polygon fill="#181818" points="1155,314.9453,1145,318.9453,1155,322.9453,1151,318.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1149" x2="1308" y1="318.9453" y2="318.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1161" y="314.1904">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25" x="1172" y="314.1904">user</text><polygon fill="#181818" points="587,343.4688,577,347.4688,587,351.4688,583,347.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="581" x2="1138" y1="347.4688" y2="347.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="593" y="342.7139">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25" x="604" y="342.7139">user</text><path d="M462.5,362.4688 L523.5,362.4688 L523.5,368.9922 L513.5,378.9922 L462.5,378.9922 L462.5,362.4688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="73.5703" style="stroke:#000000;stroke-width:1.5;" width="570" x="462.5" y="362.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="477.5" y="375.2373">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="176" x="538.5" y="374.4268">[user.getRoles = "MODERATOR"]</text><polygon fill="#181818" points="886,395.5156,896,399.5156,886,403.5156,890,399.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="892" y1="399.5156" y2="399.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="583" y="394.7607">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="594" y="394.7607">reviewRepository.updateReview(resource,idReview)</text><polygon fill="#181818" points="587,424.0391,577,428.0391,587,432.0391,583,428.0391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="581" x2="902" y1="428.0391" y2="428.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="593" y="423.2842">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="611" y="423.2842">ok</text><polygon fill="#181818" points="279,459.5625,269,463.5625,279,467.5625,275,463.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="273" x2="565" y1="463.5625" y2="463.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="285" y="458.8076">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="303" y="458.8076">review</text><polygon fill="#181818" points="47,488.0859,37,492.0859,47,496.0859,43,492.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41" x2="257" y1="492.0859" y2="492.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="53" y="487.3311">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="71" y="487.3311">review</text><!--MD5=[7f270c8292922f8ee8042b0d3d586d36]
@startuml
'https://plantuml.com/sequence-diagram

title Approve or reject a pending review
autoactivate on
autonumber

actor "Client" as client
participant "ModeratorController" as controller
participant "reviewService:ReviewService" as service
participant "reviewRepository:ReviewRepository" as repository
participant "requestService:RequestService" as request
participant ":AuthInstance" as instanceAuth

activate client

client -> controller: PUT /moderator/review/{idReview}
controller -> service : reviewService.changeStatus(idReview,resource)

service -> request : parseJwt(request)
request - -> service: jwt
service -> request: makeRequestToAuthentication(jwt)
request -> instanceAuth: GET /auth/search/{jwt}
instanceAuth - -> request: user
request - -> service: user
alt user.getRoles = "MODERATOR"
    service -> repository: reviewRepository.updateReview(resource,idReview)
    repository - -> service: ok
end


service -> controller: review
controller -> client: review

@enduml

@startuml

title Approve or reject a pending review
autoactivate on
autonumber

actor "Client" as client
participant "ModeratorController" as controller
participant "reviewService:ReviewService" as service
participant "reviewRepository:ReviewRepository" as repository
participant "requestService:RequestService" as request
participant ":AuthInstance" as instanceAuth

activate client

client -> controller: PUT /moderator/review/{idReview}
controller -> service : reviewService.changeStatus(idReview,resource)

service -> request : parseJwt(request)
request - -> service: jwt
service -> request: makeRequestToAuthentication(jwt)
request -> instanceAuth: GET /auth/search/{jwt}
instanceAuth - -> request: user
request - -> service: user
alt user.getRoles = "MODERATOR"
    service -> repository: reviewRepository.updateReview(resource,idReview)
    repository - -> service: ok
end


service -> controller: review
controller -> client: review

@enduml

PlantUML version 1.2022.12(Sun Oct 23 19:12:26 WEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>