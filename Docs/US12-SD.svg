<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="551px" preserveAspectRatio="none" style="width:1225px;height:551px;background:#FFFFFF;" version="1.1" viewBox="0 0 1225 551" width="1225px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="292" x="465.5" y="30.1074">Obtain the aggregated rating of a product</text><rect fill="#FFFFFF" height="326.2402" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="133.2422"/><rect fill="#FFFFFF" height="293.9492" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="156.5332"/><rect fill="#FFFFFF" height="231.3672" style="stroke:#181818;stroke-width:1.0;" width="10" x="383" y="187.8242"/><rect fill="#FFFFFF" height="168.7852" style="stroke:#181818;stroke-width:1.0;" width="10" x="610" y="219.1152"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="962" y="250.4063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="123.2422" y2="468.4824"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="207" x2="207" y1="123.2422" y2="468.4824"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="387.5" x2="387.5" y1="123.2422" y2="468.4824"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="615" x2="615" y1="123.2422" y2="468.4824"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="967" x2="967" y1="123.2422" y2="468.4824"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1156" x2="1156" y1="321.5078" y2="468.4824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="119.7285">Client</text><ellipse cx="26" cy="53.1211" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,61.1211 L26,88.1211 M13,69.1211 L39,69.1211 M26,88.1211 L13,103.1211 M26,88.1211 L39,103.1211 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="482.5898">Client</text><ellipse cx="26" cy="494.6035" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,502.6035 L26,529.6035 M13,510.6035 L39,510.6035 M26,529.6035 L13,544.6035 M26,529.6035 L39,544.6035 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="162" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="169" y="111.7285">:ReviewQ_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="162" y="467.4824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="169" y="489.5898">:ReviewQ_n</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="327.5" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="334.5" y="111.7285">ReviewController</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="327.5" y="467.4824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="334.5" y="489.5898">ReviewController</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="192" x="519" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178" x="526" y="111.7285">reviewService:reviewService</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="192" x="519" y="467.4824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178" x="526" y="489.5898">reviewService:reviewService</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="850" y="89.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="857" y="111.7285">reviewRepository:reviewRepository</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="850" y="467.4824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="857" y="489.5898">reviewRepository:reviewRepository</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="1094" y="467.4824"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1101" y="489.5898">:AggregateRating</text><rect fill="#FFFFFF" height="326.2402" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="133.2422"/><rect fill="#FFFFFF" height="293.9492" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="156.5332"/><rect fill="#FFFFFF" height="231.3672" style="stroke:#181818;stroke-width:1.0;" width="10" x="383" y="187.8242"/><rect fill="#FFFFFF" height="168.7852" style="stroke:#181818;stroke-width:1.0;" width="10" x="610" y="219.1152"/><rect fill="#FFFFFF" height="31.291" style="stroke:#181818;stroke-width:1.0;" width="10" x="962" y="250.4063"/><polygon fill="#181818" points="190,152.5332,200,156.5332,190,160.5332,194,156.5332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="196" y1="156.5332" y2="156.5332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="38" y="151.2705">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="49" y="151.2705">GET/reviews/{sku}/rating</text><polygon fill="#181818" points="371,183.8242,381,187.8242,371,191.8242,375,187.8242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="377" y1="187.8242" y2="187.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="219" y="182.5615">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="230" y="182.5615">GET/reviews/{sku}/rating</text><polygon fill="#181818" points="598,215.1152,608,219.1152,598,223.1152,602,219.1152" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="393" x2="604" y1="219.1152" y2="219.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="400" y="213.8525">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="411" y="213.8525">productService.findAllRates(sku)</text><polygon fill="#181818" points="950,246.4063,960,250.4063,950,254.4063,954,250.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="620" x2="956" y1="250.4063" y2="250.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="627" y="245.1436">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="638" y="245.1436">productRepository.findAllApprovedReviewsBySku(sku)</text><polygon fill="#181818" points="631,277.6973,621,281.6973,631,285.6973,627,281.6973" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="625" x2="966" y1="281.6973" y2="281.6973"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="637" y="276.4346">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="648" y="276.4346">reviews</text><polygon fill="#181818" points="1082,308.9883,1092,312.9883,1082,316.9883,1086,312.9883" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="620" x2="1088" y1="312.9883" y2="312.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="627" y="307.7256">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="638" y="307.7256">new AggregateRating(reviews))</text><rect fill="#E2E2F0" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="1094" y="289.6973"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1101" y="311.8047">:AggregateRating</text><polygon fill="#181818" points="631,352.6094,621,356.6094,631,360.6094,627,356.6094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="625" x2="1155.5" y1="356.6094" y2="356.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="637" y="351.3467">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="648" y="351.3467">aggregateRating</text><polygon fill="#181818" points="404,383.9004,394,387.9004,404,391.9004,400,387.9004" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="398" x2="614" y1="387.9004" y2="387.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="410" y="382.6377">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="421" y="382.6377">aggregateRating</text><polygon fill="#181818" points="223,415.1914,213,419.1914,223,423.1914,219,419.1914" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="217" x2="387" y1="419.1914" y2="419.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="229" y="413.9287">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="240" y="413.9287">aggregateRating</text><polygon fill="#181818" points="42,446.4824,32,450.4824,42,454.4824,38,450.4824" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="206" y1="450.4824" y2="450.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="48" y="445.2197">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="66" y="445.2197">aggregateRating</text><!--MD5=[8a20060d0ba2b477e2f0b9bcf58fddec]
@startuml
'https://plantuml.com/sequence-diagram

title Obtain the aggregated rating of a product

autoactivate on
autonumber

actor "Client" as Client
participant ":ReviewQ_n" as reviewQ
participant "ReviewController" as Ctrl
participant "reviewService:reviewService" as Svc
participant "reviewRepository:reviewRepository" as Repo
participant ":AggregateRating" as aggregateRating

activate Client

Client -> reviewQ : GET/reviews/{sku}/rating
reviewQ -> Ctrl: GET/reviews/{sku}/rating
Ctrl -> Svc : productService.findAllRates(sku)
Svc -> Repo: productRepository.findAllApprovedReviewsBySku(sku)
Repo - -> Svc: reviews
Svc -> aggregateRating**: new AggregateRating(reviews))
aggregateRating - -> Svc: aggregateRating
Svc - -> Ctrl: aggregateRating
Ctrl - -> reviewQ: aggregateRating
reviewQ - -> Client: aggregateRating





@enduml

@startuml

title Obtain the aggregated rating of a product

autoactivate on
autonumber

actor "Client" as Client
participant ":ReviewQ_n" as reviewQ
participant "ReviewController" as Ctrl
participant "reviewService:reviewService" as Svc
participant "reviewRepository:reviewRepository" as Repo
participant ":AggregateRating" as aggregateRating

activate Client

Client -> reviewQ : GET/reviews/{sku}/rating
reviewQ -> Ctrl: GET/reviews/{sku}/rating
Ctrl -> Svc : productService.findAllRates(sku)
Svc -> Repo: productRepository.findAllApprovedReviewsBySku(sku)
Repo - -> Svc: reviews
Svc -> aggregateRating**: new AggregateRating(reviews))
aggregateRating - -> Svc: aggregateRating
Svc - -> Ctrl: aggregateRating
Ctrl - -> reviewQ: aggregateRating
reviewQ - -> Client: aggregateRating





@enduml

PlantUML version 1.2022.13(Sat Nov 19 13:22:17 WET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>