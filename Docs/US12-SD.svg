<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="457px" preserveAspectRatio="none" style="width:1044px;height:457px;background:#FFFFFF;" version="1.1" viewBox="0 0 1044 457" width="1044px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="25.6406" id="_title" style="stroke:none;stroke-width:1.0;" width="302" x="370" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="292" x="375" y="27.6738">Obtain the aggregated rating of a product</text><rect fill="#FFFFFF" height="241.3047" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="127.2813"/><rect fill="#FFFFFF" height="211.7813" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="147.8047"/><rect fill="#FFFFFF" height="154.7344" style="stroke:#181818;stroke-width:1.0;" width="10" x="429" y="176.3281"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="781" y="204.8516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="117.2813" y2="377.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="206.5" x2="206.5" y1="117.2813" y2="377.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="434" x2="434" y1="117.2813" y2="377.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="786" x2="786" y1="117.2813" y2="377.5859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="975" x2="975" y1="271.6953" y2="377.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="114.3145">Client</text><ellipse cx="26" cy="50.1406" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,58.1406 L26,85.1406 M13,66.1406 L39,66.1406 M26,85.1406 L13,100.1406 M26,85.1406 L39,100.1406 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="5" y="389.2598">Client</text><ellipse cx="26" cy="400.7266" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26,408.7266 L26,435.7266 M13,416.7266 L39,416.7266 M26,435.7266 L13,450.7266 M26,435.7266 L39,450.7266 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="146.5" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="153.5" y="106.3145">ReviewController</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="146.5" y="376.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="153.5" y="396.2598">ReviewController</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="192" x="338" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178" x="345" y="106.3145">reviewService:reviewService</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="192" x="338" y="376.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178" x="345" y="396.2598">reviewService:reviewService</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="669" y="86.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="676" y="106.3145">reviewRepository:reviewRepository</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="669" y="376.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="676" y="396.2598">reviewRepository:reviewRepository</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="913" y="376.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="920" y="396.2598">:AggregateRating</text><rect fill="#FFFFFF" height="241.3047" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="127.2813"/><rect fill="#FFFFFF" height="211.7813" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="147.8047"/><rect fill="#FFFFFF" height="154.7344" style="stroke:#181818;stroke-width:1.0;" width="10" x="429" y="176.3281"/><rect fill="#FFFFFF" height="28.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="781" y="204.8516"/><polygon fill="#181818" points="190,143.8047,200,147.8047,190,151.8047,194,147.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="196" y1="147.8047" y2="147.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="38" y="143.0498">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="49" y="143.0498">GET/reviews/{sku}/rating</text><polygon fill="#181818" points="417,172.3281,427,176.3281,417,180.3281,421,176.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="423" y1="176.3281" y2="176.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="219" y="171.5732">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="230" y="171.5732">productService.findAllRates(sku)</text><polygon fill="#181818" points="769,200.8516,779,204.8516,769,208.8516,773,204.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="439" x2="775" y1="204.8516" y2="204.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="446" y="200.0967">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="457" y="200.0967">productRepository.findAllApprovedReviewsBySku(sku)</text><polygon fill="#181818" points="450,229.375,440,233.375,450,237.375,446,233.375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="444" x2="785" y1="233.375" y2="233.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="456" y="228.6201">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="467" y="228.6201">reviews</text><polygon fill="#181818" points="901,257.8984,911,261.8984,901,265.8984,905,261.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="439" x2="907" y1="261.8984" y2="261.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="446" y="257.1436">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="457" y="257.1436">new ReviewDTO(review))</text><rect fill="#E2E2F0" height="29.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="913" y="241.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="920" y="261.0488">:AggregateRating</text><polygon fill="#181818" points="450,298.5391,440,302.5391,450,306.5391,446,302.5391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="444" x2="974.5" y1="302.5391" y2="302.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="456" y="297.7842">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="467" y="297.7842">rating</text><polygon fill="#181818" points="223,327.0625,213,331.0625,223,335.0625,219,331.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="217" x2="433" y1="331.0625" y2="331.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="229" y="326.3076">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="240" y="326.3076">rating</text><polygon fill="#181818" points="42,355.5859,32,359.5859,42,363.5859,38,359.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="206" y1="359.5859" y2="359.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="48" y="354.8311">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="59" y="354.8311">rating</text><!--MD5=[1c35988341b2abb4ab258d2b1978fb14]
@startuml
'https://plantuml.com/sequence-diagram

title Obtain the aggregated rating of a product

autoactivate on
autonumber

actor "Client" as Client
participant "ReviewController" as Ctrl
participant "reviewService:reviewService" as Svc
participant "reviewRepository:reviewRepository" as Repo
participant ":AggregateRating" as aggregateRating

activate Client

Client -> Ctrl : GET/reviews/{sku}/rating
Ctrl -> Svc : productService.findAllRates(sku)
Svc -> Repo: productRepository.findAllApprovedReviewsBySku(sku)
Repo - -> Svc: reviews
Svc -> aggregateRating**: new ReviewDTO(review))
aggregateRating - -> Svc: rating
Svc - -> Ctrl: rating
Ctrl - -> Client: rating





@enduml

@startuml

title Obtain the aggregated rating of a product

autoactivate on
autonumber

actor "Client" as Client
participant "ReviewController" as Ctrl
participant "reviewService:reviewService" as Svc
participant "reviewRepository:reviewRepository" as Repo
participant ":AggregateRating" as aggregateRating

activate Client

Client -> Ctrl : GET/reviews/{sku}/rating
Ctrl -> Svc : productService.findAllRates(sku)
Svc -> Repo: productRepository.findAllApprovedReviewsBySku(sku)
Repo - -> Svc: reviews
Svc -> aggregateRating**: new ReviewDTO(review))
aggregateRating - -> Svc: rating
Svc - -> Ctrl: rating
Ctrl - -> Client: rating





@enduml

PlantUML version 1.2022.12(Sun Oct 23 19:12:26 WEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>